<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“ åœ‹å…§ç•¢æ—…è¨±é¡˜èª¿æŸ¥ âœˆï¸</title>
    <!-- Load Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb;
        }
        /* Custom message box styles */
        #messageBox {
            transition: opacity 0.3s ease-in-out;
        }
    </style>
</head>
<body class="p-4 sm:p-8 min-h-screen flex items-center justify-center">

    <div class="w-full max-w-2xl bg-white shadow-2xl rounded-xl p-6 sm:p-10 border-t-8 border-indigo-500">
        <!-- Header Section -->
        <header class="mb-8 text-center">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-indigo-700 mb-2">
                ğŸ“ åœ‹å…§ç•¢æ—…è¨±é¡˜èª¿æŸ¥ âœˆï¸
            </h1>
            <p class="text-gray-600 leading-relaxed text-sm sm:text-base">
                åŒå­¸å¥½ï½é‡å°åœ‹å…§ç•¢æ¥­æ—…è¡Œï¼Œæƒ³è½è½åŒå­¸é¡˜æœ›ã€‚ç›¡é‡å¯ä»¥æ»¿è¶³å¤§å®¶è¨±å¯æ™‚é–“å’Œæƒ³å»çš„åœ°é»ã€‚æ­¡è¿æ”œå®¶å¸¶çœ·å…±è¥„ç››èˆ‰ã€‚
            </p>
            <p class="mt-2 text-sm font-semibold text-red-500">
                âš ï¸ èª¿æŸ¥æ™‚é–“åˆ° 11/30 æˆªæ­¢ï¼
            </p>
        </header>

        <!-- Form Section -->
        <form id="travelForm" class="space-y-6">

            <!-- Message Box for Success/Error -->
            <div id="messageBox" class="p-4 rounded-lg text-sm hidden opacity-0 transition-opacity" role="alert"></div>

            <!-- Question 1: Name -->
            <div class="bg-gray-50 p-5 rounded-lg border border-gray-200">
                <label for="name" class="block text-lg font-bold text-gray-800 mb-3">
                    1. æ‚¨çš„åå­—ï¼Ÿ
                </label>
                <input type="text" id="name" name="åå­—"
                       placeholder="ä¾‹å¦‚ï¼šç‹å°æ˜"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150">
            </div>

            <!-- Question 2: Location -->
            <div class="bg-gray-50 p-5 rounded-lg border border-gray-200">
                <label for="location" class="block text-lg font-bold text-gray-800 mb-3">
                    2. é¡˜æœ›åœ‹å…§æ—…éŠåœ°é»æ˜¯ï¼Ÿ (ç°¡ç­”)
                </label>
                <input type="text" id="location" name="åœ°é»" required
                       placeholder="ä¾‹å¦‚ï¼šå®œè˜­å¤ªå¹³å±±ã€å¸é¦¬åº«æ–¯ã€æ­¦é™µè¾²å ´ç­‰..."
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150">
            </div>
            
            <!-- NEW Question 3: Reference URL/Itinerary -->
            <div class="bg-gray-50 p-5 rounded-lg border border-gray-200">
                <label for="reference" class="block text-lg font-bold text-gray-800 mb-3">
                    3. åƒè€ƒç¶²å€/è¡Œç¨‹å»ºè­°ï¼Ÿ (é¸å¡«)
                </label>
                <input type="text" id="reference" name="åƒè€ƒç¶²å€/è¡Œç¨‹"
                       placeholder="æä¾›åƒè€ƒç¶²å€æˆ–ç°¡è¿°æ‚¨æƒ³å»çš„è¡Œç¨‹ï¼ˆä¾‹å¦‚ï¼šDay1....Day2....ï¼‰"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 transition duration-150">
            </div>

            <!-- Question 4: Duration (Original Q3) -->
            <div class="bg-gray-50 p-5 rounded-lg border border-gray-200">
                <p class="block text-lg font-bold text-gray-800 mb-3">
                    4. åå¥½çš„æ—…è¡Œå¤©æ•¸ï¼Ÿ (äºŒé¸ä¸€)
                </p>
                <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-6">
                    <label class="inline-flex items-center text-gray-700 cursor-pointer">
                        <input type="radio" name="å¤©æ•¸" value="å…©å¤©ä¸€å¤œ" required
                               class="form-radio h-5 w-5 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                        <span class="ml-3 text-base">å…©å¤©ä¸€å¤œ </span>
                    </label>
                    <label class="inline-flex items-center text-gray-700 cursor-pointer">
                        <input type="radio" name="å¤©æ•¸" value="ä¸‰å¤©å…©å¤œ"
                               class="form-radio h-5 w-5 text-indigo-600 border-gray-300 focus:ring-indigo-500">
                        <span class="ml-3 text-base">ä¸‰å¤©å…©å¤œ </span>
                    </label>
                </div>
            </div>

            <!-- Question 5: Time Options (Original Q4) -->
            <div class="bg-gray-50 p-5 rounded-lg border border-gray-200">
                <p class="block text-lg font-bold text-gray-800 mb-3">
                    5. æ–¹ä¾¿çš„æ—…éŠæ™‚é–“é¸é …ï¼Ÿ (è«‹é¸æ“‡æœ€åˆé©çš„ä¸€é …)
                </p>
                <div class="space-y-3">
                    <!-- Radio options for Time -->
                    <label class="flex items-center text-gray-700 cursor-pointer">
                        <input type="radio" name="æ™‚é–“" value="5æœˆç¬¬ä¸€é€± (å‹å‹•ç¯€)" required
                               class="time-option form-radio h-5 w-5 text-indigo-600 focus:ring-indigo-500">
                        <span class="ml-3 text-base">5æœˆç¬¬ä¸€é€± (å‹å‹•ç¯€)</span>
                    </label>
                    <label class="flex items-center text-gray-700 cursor-pointer">
                        <input type="radio" name="æ™‚é–“" value="5æœˆç¬¬äºŒé€±"
                               class="time-option form-radio h-5 w-5 text-indigo-600 focus:ring-indigo-500">
                        <span class="ml-3 text-base">5æœˆç¬¬äºŒé€±</span>
                    </label>
                    <label class="flex items-center text-gray-700 cursor-pointer">
                        <input type="radio" name="æ™‚é–“" value="5æœˆç¬¬ä¸‰é€±"
                               class="time-option form-radio h-5 w-5 text-indigo-600 focus:ring-indigo-500">
                        <span class="ml-3 text-base">5æœˆç¬¬ä¸‰é€±</span>
                    </label>
                    <label class="flex items-center text-gray-700 cursor-pointer">
                        <input type="radio" name="æ™‚é–“" value="5æœˆç¬¬å››é€±"
                               class="time-option form-radio h-5 w-5 text-indigo-600 focus:ring-indigo-500">
                        <span class="ml-3 text-base">5æœˆç¬¬å››é€±</span>
                    </label>
                    <label class="flex items-center text-gray-700 cursor-pointer">
                        <input type="radio" name="æ™‚é–“" value="æ™‚é–“éƒ½å¯ä»¥"
                               class="time-option form-radio h-5 w-5 text-indigo-600 focus:ring-indigo-500">
                        <span class="ml-3 text-base">æ™‚é–“éƒ½å¯ä»¥</span>
                    </label>
                    <label class="flex items-center text-gray-700 cursor-pointer">
                        <input type="radio" name="æ™‚é–“" value="å…¶ä»–æ™‚é–“" id="otherTimeOption"
                               class="time-option form-radio h-5 w-5 text-indigo-600 focus:ring-indigo-500">
                        <span class="ml-3 text-base">å…¶ä»–æ™‚é–“</span>
                    </label>
                </div>
            </div>

            <!-- Question 6: Other Time Details (Original Q5, Conditional) -->
            <div id="otherTimeDetail" class="bg-yellow-50 p-5 rounded-lg border border-yellow-200 hidden transition-all duration-300">
                <label for="otherTimeText" class="block text-lg font-bold text-gray-800 mb-3">
                    6. è«‹ç°¡ç­”æ‚¨æ–¹ä¾¿çš„ã€Œå…¶ä»–æ™‚é–“ã€ï¼š
                </label>
                <input type="text" id="otherTimeText" name="å…¶ä»–æ™‚é–“èªªæ˜"
                       placeholder="è«‹å…·é«”èªªæ˜æ‚¨çš„æ™‚é–“ï¼Œä¾‹å¦‚ï¼š6æœˆç¬¬äºŒé€±æœ«"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-yellow-500 focus:border-yellow-500 transition duration-150">
            </div>

            <!-- Submit Button -->
            <button type="submit" id="submitButton"
                    class="w-full bg-indigo-600 text-white font-bold py-3 rounded-lg hover:bg-indigo-700 transition duration-200 ease-in-out shadow-lg focus:outline-none focus:ring-4 focus:ring-indigo-500 focus:ring-opacity-50 flex items-center justify-center disabled:bg-gray-400"
                    disabled>
                <span id="buttonText">é€å‡ºå•å· (åŒ¿å)</span>
                <svg id="loadingSpinner" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            </button>
        </form>

        <footer class="mt-6 text-center text-gray-400 text-xs">
            æ„Ÿè¬æ‚¨çš„å¡«å¯«ï¼ŒæœŸå¾…æˆ‘å€‘èƒ½å…±åŒå‰µé€ ç¾å¥½çš„ç•¢æ¥­æ—…ç¨‹å›æ†¶ï¼
        </footer>

    </div>

    <script>
        // Placeholder URL for your deployed Google Apps Script Web App
        // IMPORTANT: REPLACE THIS WITH YOUR ACTUAL DEPLOYED SCRIPT URL!
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzOFqPnLWT2q-ri6_HdS-URNp_zh1EdNvHbaLo5fCY9OzNrOgD4cR8bg8zM0kQtGSc/exec"; 
        
        const form = document.getElementById('travelForm');
        const otherTimeOption = document.getElementById('otherTimeOption');
        const otherTimeDetail = document.getElementById('otherTimeDetail');
        const submitButton = document.getElementById('submitButton');
        const buttonText = document.getElementById('buttonText');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const messageBox = document.getElementById('messageBox');
        
        // --- Utility Functions ---
        
        // Function to show a custom message box
        function showMessage(type, message) {
            messageBox.classList.remove('hidden', 'bg-green-100', 'text-green-800', 'bg-red-100', 'text-red-800');
            messageBox.classList.add(type === 'success' ? 'bg-green-100' : 'bg-red-100', type === 'success' ? 'text-green-800' : 'text-red-800');
            messageBox.innerHTML = message;
            // Force reflow for transition to work
            void messageBox.offsetWidth; 
            messageBox.classList.remove('opacity-0');
        }

        // Function to hide the message box
        function hideMessage() {
            messageBox.classList.add('opacity-0');
            setTimeout(() => {
                messageBox.classList.add('hidden');
            }, 300); // Match transition duration
        }

        // Function to set loading state
        function setLoading(isLoading) {
            submitButton.disabled = isLoading;
            if (isLoading) {
                buttonText.textContent = 'è³‡æ–™é€å‡ºä¸­...';
                loadingSpinner.classList.remove('hidden');
            } else {
                buttonText.textContent = 'é€å‡ºå•å· (åŒ¿å)';
                loadingSpinner.classList.add('hidden');
            }
        }

        // --- Event Listeners and Logic ---

        // Check form validity and enable submit button
        form.addEventListener('input', () => {
            hideMessage();
            // Enable button only if all required fields are filled (browser handles required)
            submitButton.disabled = !form.checkValidity();
        });

        // Toggle visibility of the "Other Time" text field
        document.querySelectorAll('.time-option').forEach(radio => {
            radio.addEventListener('change', () => {
                if (otherTimeOption.checked) {
                    otherTimeDetail.classList.remove('hidden');
                    otherTimeDetail.classList.add('block');
                    document.getElementById('otherTimeText').required = true; 
                } else {
                    otherTimeDetail.classList.add('hidden');
                    otherTimeDetail.classList.remove('block');
                    document.getElementById('otherTimeText').required = false;
                    document.getElementById('otherTimeText').value = ''; // Clear if hidden
                }
                submitButton.disabled = !form.checkValidity();
            });
        });
        
        // Initial check for 'otherTimeOption' on page load
        if (otherTimeOption.checked) {
            otherTimeDetail.classList.remove('hidden');
            otherTimeDetail.classList.add('block');
        }


        // Handle Form Submission
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            hideMessage();
            setLoading(true);

            // Collect form data
            const formData = new FormData(form);
            const data = {};
            
            // Convert FormData to a simple object
            for (let [key, value] of formData.entries()) {
                // Ensure the "å…¶ä»–æ™‚é–“èªªæ˜" only gets sent if "å…¶ä»–æ™‚é–“" was selected
                if (key === 'å…¶ä»–æ™‚é–“èªªæ˜' && data['æ™‚é–“'] !== 'å…¶ä»–æ™‚é–“') {
                    continue; 
                }
                data[key] = value.trim();
            }

            // Add Submission Timestamp
            data['å¡«å¯«æ™‚é–“'] = new Date().toLocaleString('zh-TW', { 
                year: 'numeric', month: '2-digit', day: '2-digit', 
                hour: '2-digit', minute: '2-digit', second: '2-digit', 
                hour12: false 
            });


            try {
                // Use fetch to post data to the Google Apps Script endpoint
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // Essential for successful Apps Script communication
                    cache: 'no-cache',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    // Convert JSON data to URL-encoded format
                    body: new URLSearchParams(data).toString(),
                });

                showMessage('success', 'âœ… æ„Ÿè¬æ‚¨çš„å¡«å¯«ï¼å•å·è³‡æ–™å·²æˆåŠŸé€å‡ºã€‚');
                form.reset();
                otherTimeDetail.classList.add('hidden'); // Hide conditional field
                document.getElementById('otherTimeText').required = false;
                submitButton.disabled = true; // Disable button after successful submission

            } catch (error) {
                console.error('Error submitting form:', error);
                showMessage('error', 'âŒ è³‡æ–™é€å‡ºå¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·šæˆ–ç¨å¾Œå†è©¦ã€‚');
            } finally {
                setLoading(false);
            }
        });
    </script>
</body>
</html>






